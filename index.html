from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.chrome.service import Service
import os, time

VIDEO_PATH = r"C:\video\test.mp4"   # 업로드할 동영상 파일 경로
TITLE = "리마 자동화 업로드 테스트"
DESCRIPTION = "리마가 직접 올린 영상입니다!"

# 크롬 프로필 경로(본인 PC에 맞게)
options = webdriver.ChromeOptions()
options.add_argument(r"--user-data-dir=C:\Users\홍길동\AppData\Local\Google\Chrome\User Data")
options.add_argument("--profile-directory=Default")
options.add_argument("--disable-gpu")
options.add_argument("--no-sandbox")

driver = webdriver.Chrome(service=Service(), options=options)

try:
    driver.get("https://studio.youtube.com/upload")
    time.sleep(5)
    file_input = driver.find_element(By.XPATH, "//input[@type='file']")
    file_input.send_keys(VIDEO_PATH)
    time.sleep(2)

    # 제목/설명 입력
    boxes = driver.find_elements(By.ID, "textbox")
    if len(boxes) >= 2:
        boxes[0].clear()
        boxes[0].send_keys(TITLE)
        boxes[1].send_keys(DESCRIPTION)
    time.sleep(1)

    # [다음] 3번 클릭
    for _ in range(3):
        driver.find_element(By.ID, "next-button").click()
        time.sleep(2)

    # 공개로 설정
    public_btn = driver.find_element(By.NAME, "PUBLIC")
    public_btn.click()
    time.sleep(1)

    # 완료
    driver.find_element(By.ID, "done-button").click()

    # 업로드 성공 대기
    timeout = time.time() + 60
    while time.time() < timeout:
        if "게시됨" in driver.page_source or "Published" in driver.page_source:
            print("✅ 업로드 성공!")
            break
        time.sleep(2)
    else:
        print("⚠️ 업로드 확인 타임아웃")

finally:
    time.sleep(5)
    driver.quit()
