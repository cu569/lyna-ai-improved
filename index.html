# YouTube 자동 업로드 - 기능만
import time
import os
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

def setup_browser():
    """브라우저 설정"""
    print("브라우저 열기...")
    driver = webdriver.Chrome()
    return driver, WebDriverWait(driver, 30)

def login(driver):
    """로그인"""
    driver.get("https://studio.youtube.com/")
    input("로그인 후 엔터: ")

def upload_video(driver, wait, video_file, title, description=""):
    """영상 업로드"""
    print(f"업로드: {title}")
    
    # 업로드 버튼
    wait.until(EC.element_to_be_clickable((By.XPATH, "//ytcp-button[@id='create-icon']"))).click()
    wait.until(EC.element_to_be_clickable((By.XPATH, "//tp-yt-paper-item[@test-id='upload-video']"))).click()
    
    # 파일 선택
    file_input = wait.until(EC.presence_of_element_located((By.XPATH, "//input[@type='file']")))
    file_input.send_keys(os.path.abspath(video_file))
    
    # 제목 입력
    time.sleep(3)
    title_field = wait.until(EC.element_to_be_clickable((By.XPATH, "//div[@id='textbox']")))
    title_field.clear()
    title_field.send_keys(title)
    
    # 설명 입력 (있으면)
    if description:
        try:
            desc_field = driver.find_element(By.XPATH, "(//div[@id='textbox'])[2]")
            desc_field.send_keys(description)
        except:
            pass
    
    # 다음 버튼들 (3번)
    for _ in range(3):
        try:
            wait.until(EC.element_to_be_clickable((By.XPATH, "//ytcp-button[@id='next-button']"))).click()
            time.sleep(2)
        except:
            pass
    
    # 게시
    wait.until(EC.element_to_be_clickable((By.XPATH, "//ytcp-button[@id='done-button']"))).click()
    time.sleep(5)
    print("완료!")

# 실행
if __name__ == "__main__":
    # 설정
    VIDEO_FILE = "test.mp4"  # 영상 파일명
    TITLE = "자동 업로드 테스트"
    DESCRIPTION = "자동으로 업로드된 영상"
    
    # 시작
    driver, wait = setup_browser()
    login(driver)
    
    if os.path.exists(VIDEO_FILE):
        upload_video(driver, wait, VIDEO_FILE, TITLE, DESCRIPTION)
    else:
        print(f"파일 없음: {VIDEO_FILE}")
    
    input("엔터로 종료: ")
    driver.quit()
