<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>리마 1.0 컨트롤 박스</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen">
  <div class="max-w-xl mx-auto p-4">
    <h1 class="text-3xl font-bold text-indigo-700 text-center mt-4">리마 1.0 메인 상황판</h1>

    <!-- 상태 -->
    <div id="statusBox" class="bg-white p-3 mt-4 rounded-xl shadow text-center">
      <span id="statusText">리마 준비 완료</span>
    </div>

    <!-- 카드 메뉴 -->
    <div class="grid grid-cols-2 gap-4 mt-6">
      <div onclick="openModal('upload')" class="rounded-xl bg-white shadow p-4 text-center hover:scale-105 transition">
        <span class="text-2xl">⬆️</span><p class="font-bold">유튜브 업로드</p>
      </div>
      <div onclick="openModal('analysis')" class="rounded-xl bg-white shadow p-4 text-center hover:scale-105 transition">
        <span class="text-2xl">📊</span><p class="font-bold">영상 분석</p>
      </div>
      <div onclick="openModal('todo')" class="rounded-xl bg-white shadow p-4 text-center hover:scale-105 transition">
        <span class="text-2xl">📝</span><p class="font-bold">오늘 할 일</p>
      </div>
      <div onclick="openModal('chat')" class="rounded-xl bg-white shadow p-4 text-center hover:scale-105 transition">
        <span class="text-2xl">💬</span><p class="font-bold">리마 대화</p>
      </div>
    </div>

    <!-- 모달 -->
    <div id="modalBG" class="fixed inset-0 bg-black bg-opacity-40 hidden justify-center items-center">
      <div class="bg-white p-6 rounded-xl w-[90vw] max-w-md relative">
        <button onclick="closeModal()" class="absolute top-3 right-4 text-xl">×</button>
        <div id="modalContent"></div>
      </div>
    </div>
  </div>

  <script>
    // 리마 기억 불러오기
    let rimaState = JSON.parse(localStorage.getItem('rimaState')) || { history: [] };

    function saveState() {
      localStorage.setItem('rimaState', JSON.stringify(rimaState));
    }

    function openModal(type){
      let html = "";
      if(type==='upload'){
        html = `
          <h2 class="text-xl font-bold mb-2">유튜브 업로드</h2>
          <input type="text" id="videoTitle" placeholder="영상 제목" class="border p-2 w-full mb-2"/>
          <button onclick="uploadVideo()" class="w-full bg-indigo-600 text-white p-2 rounded">업로드</button>
        `;
      } else if(type==='analysis'){
        html = `
          <h2 class="text-xl font-bold mb-2">영상 분석</h2>
          <button onclick="analyzeVideo()" class="w-full bg-indigo-600 text-white p-2 rounded">분석 시작</button>
        `;
      } else if(type==='todo'){
        html = `
          <h2 class="text-xl font-bold mb-2">오늘 할 일</h2>
          <textarea id="todoInput" placeholder="할 일 입력" class="border p-2 w-full mb-2"></textarea>
          <button onclick="saveTodo()" class="w-full bg-indigo-600 text-white p-2 rounded">저장</button>
        `;
      } else if(type==='chat'){
        html = `
          <h2 class="text-xl font-bold mb-2">리마와 대화</h2>
          <div id="chatBox" class="border p-2 h-32 overflow-y-auto mb-2 bg-gray-50">${rimaState.history.map(m=>`<div>${m}</div>`).join("")}</div>
          <input type="text" id="chatInput" placeholder="메시지 입력" class="border p-2 w-full mb-2"/>
          <button onclick="sendChat()" class="w-full bg-indigo-600 text-white p-2 rounded">전송</button>
        `;
      }
      document.getElementById('modalContent').innerHTML = html;
      document.getElementById('modalBG').classList.remove('hidden');
    }

    function closeModal(){
      document.getElementById('modalBG').classList.add('hidden');
    }

    function uploadVideo(){
      const title = document.getElementById('videoTitle').value;
      document.getElementById('statusText').innerText = `업로드 준비: ${title}`;
      rimaState.history.push(`업로드 요청: ${title}`);
      saveState();
      closeModal();
    }

    function analyzeVideo(){
      document.getElementById('statusText').innerText = "영상 분석 중...";
      rimaState.history.push("영상 분석 요청");
      saveState();
      closeModal();
    }

    function saveTodo(){
      const todo = document.getElementById('todoInput').value;
      rimaState.history.push(`할 일: ${todo}`);
      document.getElementById('statusText').innerText = "오늘 할 일 저장됨";
      saveState();
      closeModal();
    }

    function sendChat(){
      const input = document.getElementById('chatInput').value;
      rimaState.history.push(`나: ${input}`);
      document.getElementById('chatBox').innerHTML += `<div>나: ${input}</div>`;
      saveState();
      document.getElementById('chatInput').value = "";
    }
  </script>
</body>
</html>
