# YouTube 자동 업로드 - 깔끔한 버전

import time
import os
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

# 설정 (여기만 수정하세요)
VIDEO_FILE = "test.mp4"      # 업로드할 영상 파일명
VIDEO_TITLE = "자동 업로드 테스트"   # 영상 제목
VIDEO_DESC = "자동으로 업로드된 영상입니다"  # 영상 설명

def youtube_upload():
    print("YouTube 자동 업로드 시작")
    
    # 브라우저 열기
    print("브라우저 시작...")
    driver = webdriver.Chrome()
    wait = WebDriverWait(driver, 30)
    
    # YouTube Studio 접속
    print("YouTube Studio 접속...")
    driver.get("https://studio.youtube.com/")
    
    # 로그인 대기
    print("로그인 해주세요!")
    input("로그인 완료 후 엔터를 눌러주세요: ")
    
    # 업로드 버튼 클릭
    print("업로드 시작...")
    create_btn = wait.until(EC.element_to_be_clickable((By.XPATH, "//ytcp-button[@id='create-icon']")))
    create_btn.click()
    
    upload_btn = wait.until(EC.element_to_be_clickable((By.XPATH, "//tp-yt-paper-item[@test-id='upload-video']")))
    upload_btn.click()
    
    # 파일 선택
    print("파일 업로드 중...")
    file_input = wait.until(EC.presence_of_element_located((By.XPATH, "//input[@type='file']")))
    file_input.send_keys(os.path.abspath(VIDEO_FILE))
    
    # 제목 입력
    print("제목 입력...")
    time.sleep(3)
    title_field = wait.until(EC.element_to_be_clickable((By.XPATH, "//div[@id='textbox']")))
    title_field.clear()
    title_field.send_keys(VIDEO_TITLE)
    
    # 설명 입력
    print("설명 입력...")
    try:
        desc_field = driver.find_element(By.XPATH, "(//div[@id='textbox'])[2]")
        desc_field.send_keys(VIDEO_DESC)
    except:
        print("설명 입력 생략")
    
    # 다음 버튼들 클릭
    print("업로드 설정...")
    for i in range(3):
        try:
            next_btn = wait.until(EC.element_to_be_clickable((By.XPATH, "//ytcp-button[@id='next-button']")))
            next_btn.click()
            time.sleep(2)
            print(f"단계 {i+1}/3 완료")
        except:
            print(f"단계 {i+1} 건너뜀")
    
    # 게시하기
    print("게시 중...")
    done_btn = wait.until(EC.element_to_be_clickable((By.XPATH, "//ytcp-button[@id='done-button']")))
    done_btn.click()
    
    # 완료 대기
    print("업로드 완료 대기...")
    time.sleep(10)
    
    print("업로드 완료!")
    driver.quit()

# 실행
if __name__ == "__main__":
    # 파일 존재 확인
    if os.path.exists(VIDEO_FILE):
        youtube_upload()
    else:
        print(f"파일을 찾을 수 없습니다: {VIDEO_FILE}")
        print("영상 파일을 이 폴더에 넣어주세요")
    
    print("프로그램 종료")
    input("엔터를 눌러 종료...")
