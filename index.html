from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.chrome.service import Service
import json, time

# 1. data.json 불러오기
with open('data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

VIDEO_PATH = data['video_path']
TITLE = data['title']
DESCRIPTION = data['description']

# 2. 크롬 프로필 경로 (로그인 상태 유지)
PROFILE_PATH = r"C:\Users\사용자이름\AppData\Local\Google\Chrome\User Data"

options = webdriver.ChromeOptions()
options.add_argument(f"--user-data-dir={PROFILE_PATH}")
options.add_argument("--profile-directory=Default")

driver = webdriver.Chrome(service=Service(), options=options)

try:
    driver.get("https://studio.youtube.com/upload")
    time.sleep(5)

    # 파일 업로드
    file_input = driver.find_element(By.XPATH, "//input[@type='file']")
    file_input.send_keys(VIDEO_PATH)
    time.sleep(2)

    # 제목/설명 입력
    boxes = driver.find_elements(By.ID, "textbox")
    if len(boxes) >= 2:
        boxes[0].clear()
        boxes[0].send_keys(TITLE)
        boxes[1].send_keys(DESCRIPTION)

    print("업로드 시작됨...")
    time.sleep(10)

    # 업로드 완료 표시
    result = {"status": "success", "message": "업로드 완료"}
except Exception as e:
    result = {"status": "fail", "message": str(e)}
finally:
    with open("result.json", "w", encoding="utf-8") as f:
        json.dump(result, f, ensure_ascii=False, indent=2)
    driver.quit()
